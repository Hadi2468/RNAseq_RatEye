###################################################
dir <- setwd("./datasets"); getwd()
getwd()
###################################################
### Step 1: Import 53 samples' information file ###
###################################################
dir <- setwd("./RNAseq_RatEye/datasets"); getwd()
getwd()
setwd("../")
getwd()
setwd("../RNAseq_RatEye/datasets"); getwd()
getwd()
setwd("../RNAseq_RatEye"); getwd()
setwd("./RNAseq_RatEye"); getwd()
Packages <- c("tximport", "tximportData", "DESeq2", "tidyverse", "dplyr", "vctrs", "fs", "ggplot2",
"corrplot", "RColorBrewer", "ggpubr", "pheatmap", "ppcor")
lapply(Packages, library, character.only = TRUE)
getwd()
setwd("./Data"); getwd()
samples <- read.csv("samples53.csv", sep=",", header=TRUE)
dim(samples)
# sub_samples <- samples[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
# write.table(sub_samples, file="samples45.csv", sep=",", quote=F, row.names=TRUE, col.names=TRUE,)
sub_samples <- read.csv("samples45.csv", sep=",", header=TRUE)
dim(sub_samples)
# sub_genes_2 <- read.csv("normalized_log2.csv", sep=",", header=TRUE)
sub_genes_r <- read.csv("normalized_rlog.csv", sep=",", header=TRUE)
# sub_genes_v <- read.csv("normalized_vst.csv", sep=",", header=TRUE)
# sub_genes_c <- read.csv("real_counts.csv", sep=",", header=TRUE)
# dim(sub_genes_2)
dim(sub_genes_r)
# selGenes <- subset(sub_genes_2, select=c(ENSRNOG00000016696_Angpt2, ENSRNOG00000055293_Ptprb, ENSRNOG00000008587_Tek))
selGenes <- subset(sub_genes_r, select=c(ENSRNOG00000016696_Angpt2, ENSRNOG00000055293_Ptprb, ENSRNOG00000008587_Tek))
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
summary(corrTable)     # Basic statistical analysis
pheatmap(cor(corrTable))
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
ThreeGenes <- read.csv("ThreeGenes.csv", sep=",", header=TRUE)
ThreeGenes$Expression[1:45] <- corrTable$ANGPT2
ThreeGenes$Expression[46:90] <- corrTable$PTPRB
ThreeGenes$Expression[91:135] <- corrTable$TEK
ggplot(ThreeGenes, aes(Expression, fill=Gene)) + geom_density(alpha=0.6) +   scale_fill_manual(values=c("red", "blue", "yellow"))
ggplot(corrTable, aes(IOP)) + geom_density(fill="green") + scale_x_continuous(limits=c(10, 25))
corrTable <- cbind(sub_samples$Class_IOP, corrTable)    # Correlation tables for three genes and three groups of IOP
names(corrTable)[1] <- "Class_IOP"
levels(corrTable$Class_IOP)
corrTable$Class_IOP <- relevel(corrTable$Class_IOP, "Normal")
levels(corrTable$Class_IOP)
corrTable_IOP2 <- corrTable
for (i in (1:45)) {if (corrTable_IOP2$Class_IOP[i] == "Elevated") {corrTable_IOP2$Class_IOP[i] <- "High"}}
corrTable_IOP2$Class_IOP <- factor(corrTable_IOP2$Class_IOP)    # Correlation tables for just two groups of IOP
levels(corrTable_IOP2$Class_IOP)
View(corrTable_IOP2)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="IOP", ylab="Gene expression") +
stat_cor(aes(color=Class_IOP), label.x=3)
ggscatter(corrTable_IOP2, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Gene expression") +
stat_cor(aes(color=Class_IOP), label.x=3)
ggANG <- ggplot(corrTable, aes(x=IOP, y=ANGPT2, color=Class_IOP)) + scale_size_manual(values=c(2,2,2)) +
geom_point(aes(size=Class_IOP)) + geom_smooth(method=lm, aes(fill=Class_IOP), se=FALSE, fullrange=TRUE) +
theme(legend.position="top") + labs(y="Expression")
ggPT <- ggplot(corrTable, aes(x=IOP, y=PTPRB, color=Class_IOP)) + scale_size_manual(values=c(2,2,2)) +
geom_point(aes(size=Class_IOP)) + geom_smooth(method=lm, aes(fill=Class_IOP), se=FALSE, fullrange=TRUE) +
theme(legend.position="top", axis.title.y = element_blank())
ggTEK <- ggplot(corrTable, aes(x=IOP, y=TEK, color=Class_IOP)) + scale_size_manual(values=c(2,2,2)) +
geom_point(aes(size=Class_IOP)) + geom_smooth(method=lm, aes(fill=Class_IOP), se=FALSE, fullrange=TRUE) +
theme(legend.position="top", axis.title.y = element_blank())
ggarrange(ggANG, ggPT, ggTEK + rremove("x.text"), labels=c("ANGPT2", "PTPRB", "TEK"), ncol=3, nrow=1)
# H0: Mean of ANGPT2 expression for samples with Normal_IOP = Mean of ANGPT2 expression for samples with High_IOP
ggplot(corrTable_IOP2, aes(x=Class_IOP, y=ANGPT2)) + geom_boxplot(color="blue", fill="pink", size=1.2)
t.test(ANGPT2 ~ Class_IOP, data=corrTable_IOP2, mu=0, alt="two.sided", conf=0.95, var.eq=F, paired=F)
# H0: Mean of ANGPT2 expression for samples with all IOP gropus are equal
ggplot(corrTable, aes(x=Class_IOP, y=ANGPT2)) + geom_boxplot(color="blue", fill="pink", size=1)
Anova_results <- aov(ANGPT2 ~ Class_IOP, data=corrTable)
summary(Anova_results)
corrTable <- cbind(sub_samples$Class_Age, sub_samples$Sex, sub_samples$Batch, corrTable)
names(corrTable)[1:3] <- c("Age", "Sex", "Batch")
levels(corrTable$Age)
levels(corrTable$Sex)
levels(corrTable$Batch)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="blue", cor.method="spearman",
title="Correlation: Spearman,    Normalization: rlog", combine = TRUE, add="reg.line", conf.int=TRUE,
cor.coef=TRUE, xlab="IOP", ylab="Expression")
ggscatter(corrTable_new, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age", cor.method="pearson", title="Correlation: Pearson,    Normalization: rlog",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="IOP", ylab="rlog-normalized gene counts", palette=c("green", "red", "blue", "black"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="blue", cor.method="spearman",
title="Correlation: Spearman,    Normalization: rlog", combine = TRUE, add="reg.line", conf.int=TRUE,
cor.coef=TRUE, xlab="IOP", ylab="Expression")
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="IOP", ylab="Gene expression") +
stat_cor(aes(color=Class_IOP), label.x=3)
ggscatter(corrTable_IOP2, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Gene expression") +
stat_cor(aes(color=Class_IOP), label.x=3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="blue",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="IOP", ylab="Expression")
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="blue",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="IOP", ylab="Expression")
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="blue",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="IOP", ylab="Expression", palette=c("green", "red", "blue", "black"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="IOP", ylab="Expression", palette=c("green", "red", "blue", "black"))
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="ANGPT2", ylab="Expression", palette=c("green", "red", "blue", "black"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="IOP", ylab="Expression", palette=c("green", "red", "blue", "black"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Sex",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression", palette=c("red", "pink", "blue"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="IOP", ylab="Expression", palette=c("green", "red", "blue", "black"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="IOP", ylab="Expression", palette=c("green", "blue", "gray", "black"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Sex",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression", palette=c("red", "pink", "blue"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="IOP", ylab="Expression", palette=c("green", "blue", "gray", "black"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression", palette=c("green", "blue", "gray", "black"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Sex",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression", palette=c("red", "pink", "blue"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Sex",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Sex), label.x=3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Age), label.x=3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Sex",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression", palette=c("red", "pink", "blue"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Sex",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Sex), label.x=3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Age), label.x=3)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="ANGPT2", ylab="Expression", palette=c("green", "blue", "gray", "black"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Age), label.x=3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Sex",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Sex), label.x=3)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Sex",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Sex))
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="ANGPT2", ylab="Expression", palette=c("green", "blue", "gray", "black"))
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Age), label.x=3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Age), label.x=3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Age), label.x=3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Sex",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Sex), label.x=3)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="ANGPT2", ylab="Expression", palette=c("green", "blue", "gray", "black"))
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression", palette=c("green", "blue", "gray", "black"))
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=3)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age))
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=4)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=0.04)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=40)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=00)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=5)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=6)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.y=10)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=6)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=6.3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Age), label.x=3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Age), label.x=6.3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Age), label.x=12)
ggscatter(corrTable, x="PTPRB", y="TEK", size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="PTPRB", ylab="TEK", palette=c("green", "blue", "gray", "black"))
ggscatter(corrTable, x="PTPRB", y="TEK", size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="PTPRB", ylab="TEK") + stat_cor(aes(color=Age), label.x=6.3)
ggscatter(corrTable, x="PTPRB", y="TEK", size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="PTPRB", ylab="TEK") + stat_cor(aes(color=Age), label.x=7)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="blue",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="IOP", ylab="Expression")
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="blue",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="IOP", ylab="Expression")
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=4)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=2)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=0)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=0)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=-1)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=-3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=-5)
ggscatter(corrTable_IOP2, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Gene expression") +
stat_cor(aes(color=Class_IOP), label.x=3)
ggscatter(corrTable_IOP2, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=-5)
ggscatter(corrTable_IOP2, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=-3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=-5)
ggscatter(corrTable_IOP2, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Class_IOP",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=TRUE, cor.coef=FALSE, xlab="IOP", ylab="Expression") +
stat_cor(aes(color=Class_IOP), label.x=-3)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Age), label.x=12)
levels(corrTable$Age)
ggscatter(corrTable, x="IOP", y=c("ANGPT2", "PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="IOP", ylab="Expression") + stat_cor(aes(color=Age), label.x=12)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=6.3)
ggscatter(corrTable, x="PTPRB", y="TEK", size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="PTPRB", ylab="TEK") + stat_cor(aes(color=Age), label.x=7)
# H0: Mean of ANGPT2 expression for samples with all Age gropus are equal
ggplot(corrTable, aes(x=Age, y=ANGPT2)) + geom_boxplot(color="blue", fill="pink", size=1)
Anova_results <- aov(ANGPT2 ~ Age, data=corrTable)
summary(Anova_results)
pcor.test(corrTable$ANGPT2, corrTable$IOP, corrTable$Age, method="spearman")
pcor.test(corrTable$ANGPT2, corrTable$Class_IOP, corrTable$Age, method="spearman")
corrTable_Age2 <- corrTable
for (i in (1:45)) {
if (corrTable_Age2$Age[i] == "A1_Adolescent") {corrTable_Age2$Age[i] <- "Adult"}
else if (corrTable_Age2$Age[i] == "A2_Adult") {corrTable_Age2$Age[i] <- "Adult"}
else if (corrTable_Age2$Age[i] == "A3_Middle_Aged") {corrTable_Age2$Age[i] <- "Aged"}
else (corrTable_Age2$Age[i] == "A4_Aged") {corrTable_Age2$Age[i] <- "Aged"} }
for (i in (1:45)) {
if (corrTable_Age2$Age[i] == "A1_Adolescent") {corrTable_Age2$Age[i] <- "Adult"}
else if (corrTable_Age2$Age[i] == "A2_Adult") {corrTable_Age2$Age[i] <- "Adult"}
else if (corrTable_Age2$Age[i] == "A3_Middle_Aged") {corrTable_Age2$Age[i] <- "Aged"}
else (corrTable_Age2$Age[i] == "A4_Aged") {corrTable_Age2$Age[i] <- "Aged"}}
for (i in (1:45)) {
if (corrTable_Age2$Age[i] == "A1_Adolescent") {corrTable_Age2$Age[i] <- "Adult"}
else if (corrTable_Age2$Age[i] == "A2_Adult") {corrTable_Age2$Age[i] <- "Adult"}
else if (corrTable_Age2$Age[i] == "A3_Middle_Aged") {corrTable_Age2$Age[i] <- "Aged"}
else (corrTable_Age2$Age[i] == "A4_Aged") {corrTable_Age2$Age[i] <- "Aged"}}
for (i in (1:45)) {
if (corrTable_Age2$Age[i] == "A1_Adolescent") {corrTable_Age2$Age[i] <- "Adult"}
else if (corrTable_Age2$Age[i] == "A2_Adult") {corrTable_Age2$Age[i] <- "Adult"}
else if (corrTable_Age2$Age[i] == "A3_Middle_Aged") {corrTable_Age2$Age[i] <- "Aged"}
else (corrTable_Age2$Age[i] == "A4_Aged") {corrTable_Age2$Age[i] <- "Aged"}
}
View(corrTable_Age2)
for (i in (1:45)) {
if (corrTable_Age2$Age[i] == "A1_Adolescent") {
corrTable_Age2$Age[i] <- "Adult"
} else if (corrTable_Age2$Age[i] == "A2_Adult") {
corrTable_Age2$Age[i] <- "Adult"
} else if (corrTable_Age2$Age[i] == "A3_Middle_Aged") {
corrTable_Age2$Age[i] <- "Aged"
} else {
corrTable_Age2$Age[i] <- "Aged"}
}
corrTable_Age2 <- corrTable
for (i in (1:45)) {
if (corrTable_Age2$Age[i] == "A1_Adolescent") {corrTable_Age2$Age[i] <- "Adult"}
else if (corrTable_Age2$Age[i] == "A2_Adult") {corrTable_Age2$Age[i] <- "Adult"}
else if (corrTable_Age2$Age[i] == "A3_Middle_Aged") {corrTable_Age2$Age[i] <- "Aged"}
else {corrTable_Age2$Age[i] <- "Aged"} }
corrTable_Age2 <- corrTable
for (i in (1:45)) {
if (corrTable_Age2$Age[i] == "A1_Adolescent") {corrTable_Age2$Age[i] <- "Adult"}
# else if (corrTable_Age2$Age[i] == "A2_Adult") {corrTable_Age2$Age[i] <- "Adult"}
# else if (corrTable_Age2$Age[i] == "A3_Middle_Aged") {corrTable_Age2$Age[i] <- "Aged"}
# else {corrTable_Age2$Age[i] <- "Aged"}
}
corrTable_Age2 <- corrTable
for (i in (1:45)) {
if (corrTable_Age2$Age[i] == "A1_Adolescent") {corrTable_Age2$Age[i] = "Adult"}
# else if (corrTable_Age2$Age[i] == "A2_Adult") {corrTable_Age2$Age[i] <- "Adult"}
# else if (corrTable_Age2$Age[i] == "A3_Middle_Aged") {corrTable_Age2$Age[i] <- "Aged"}
# else {corrTable_Age2$Age[i] <- "Aged"}
}
levels(corrTable_Age2$Age) <- c("Adolescent", "Adult", "Middle_Aged", "Aged")
corrTable_Age2 <- corrTable
levels(corrTable_Age2$Age) <- c("Adolescent", "Adult", "Middle_Aged", "Aged")
corrTable_Age2 <- corrTable
levels(corrTable_Age2$Age) <- c("Adolescent", "Adult", "Middle_Aged", "Aged")
for (i in (1:45)) {if (corrTable_Age2$Age[i] == "Adolescent") {corrTable_Age2$Age[i] <- "Adult"}}
for (i in (1:45)) {if (corrTable_Age2$Age[i] == "Middle_Aged") {corrTable_Age2$Age[i] <- "Aged"}}
corrTable_Age2$Age <- factor(corrTable_Age2$Age)    # Correlation tables for just two groups of Age
levels(corrTable_Age2$Age)
ggplot(corrTable, aes(x=Age, y=ANGPT2)) + geom_boxplot(color="blue", fill="pink", size=1)
ggplot(corrTable_Age2, aes(x=Age, y=ANGPT2)) + geom_boxplot(color="blue", fill="pink", size=1)
Anova_results <- aov(ANGPT2 ~ Age, data=corrTable_Age2)
summary(Anova_results)
corrTable_Age2 <- corrTable
levels(corrTable_Age2$Age) <- c("Adolescent", "Adult", "Middle_Aged", "Other")
for (i in (1:45)) {if (corrTable_Age2$Age[i] == "Adolescent") {corrTable_Age2$Age[i] <- "Other"}}
for (i in (1:45)) {if (corrTable_Age2$Age[i] == "Middle_Aged") {corrTable_Age2$Age[i] <- "Other"}}
corrTable_Age2$Age <- factor(corrTable_Age2$Age)    # Correlation tables for just two groups of Age
levels(corrTable_Age2$Age)
# H0: Mean of ANGPT2 expression for samples with all Age gropus are equal
ggplot(corrTable, aes(x=Age, y=ANGPT2)) + geom_boxplot(color="blue", fill="pink", size=1)
ggplot(corrTable_Age2, aes(x=Age, y=ANGPT2)) + geom_boxplot(color="blue", fill="pink", size=1)
Anova_results <- aov(ANGPT2 ~ Age, data=corrTable_Age2)
summary(Anova_results)
corrTable_Age2 <- corrTable
levels(corrTable_Age2$Age) <- c("Adolescent", "Adult", "Middle_Aged", "Aged")
for (i in (1:45)) {if (corrTable_Age2$Age[i] == "Adolescent") {corrTable_Age2$Age[i] <- "Adult"}}
for (i in (1:45)) {if (corrTable_Age2$Age[i] == "Middle_Aged") {corrTable_Age2$Age[i] <- "Adult"}}
corrTable_Age2$Age <- factor(corrTable_Age2$Age)    # Correlation tables for just two groups of Age
levels(corrTable_Age2$Age)
ggplot(corrTable_Age2, aes(x=Age, y=ANGPT2)) + geom_boxplot(color="blue", fill="pink", size=1)
Anova_results <- aov(ANGPT2 ~ Age, data=corrTable_Age2)
summary(Anova_results)
corrTable_Age2 <- corrTable
levels(corrTable_Age2$Age) <- c("Adolescent", "Others", "Middle_Aged", "Aged")
for (i in (1:45)) {if (corrTable_Age2$Age[i] == "Adolescent") {corrTable_Age2$Age[i] <- "Others"}}
for (i in (1:45)) {if (corrTable_Age2$Age[i] == "Middle_Aged") {corrTable_Age2$Age[i] <- "Others"}}
corrTable_Age2$Age <- factor(corrTable_Age2$Age)    # Correlation tables for just two groups of Age
levels(corrTable_Age2$Age)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=6.3)
ggplot(corrTable_Age2, aes(x=Age, y=ANGPT2)) + geom_boxplot(color="blue", fill="pink", size=1)
Anova_results <- aov(ANGPT2 ~ Age, data=corrTable_Age2)
summary(Anova_results)
corrTable_Age2 <- corrTable
levels(corrTable_Age2$Age) <- c("Adolescent", "Adolescent_&_Adult", "Middle_Aged", "Middle_Aged_&_Aged")
for (i in (1:45)) {if (corrTable_Age2$Age[i] == "Adolescent") {corrTable_Age2$Age[i] <- "Adolescent_&_Adult"}}
for (i in (1:45)) {if (corrTable_Age2$Age[i] == "Middle_Aged") {corrTable_Age2$Age[i] <- "Middle_Aged_&_Aged"}}
corrTable_Age2$Age <- factor(corrTable_Age2$Age)    # Correlation tables for just two groups of Age
levels(corrTable_Age2$Age)
ggscatter(corrTable, x="ANGPT2", y=c("PTPRB", "TEK"), size=3, shape=19, color="Age",
cor.method="spearman", title="Correlation: Spearman,    Normalization: rlog", combine=TRUE,
add="reg.line", conf.int=FALSE, cor.coef=FALSE, xlab="ANGPT2", ylab="Expression") + stat_cor(aes(color=Age), label.x=6.3)
ggplot(corrTable_Age2, aes(x=Age, y=ANGPT2)) + geom_boxplot(color="blue", fill="pink", size=1)
Anova_results <- aov(ANGPT2 ~ Age, data=corrTable_Age2)
summary(Anova_results)
######## Partial Correlation Tests (Dr. Chen) ########
corrTable <- cbind(sub_samples$Avg_IOP, sub_samples$AgeInDays, sub_samples$Batch, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "Age", "Batch", "ANGPT2", "PTPRB", "TEK")
pcor.test(corrTable$ANGPT2, corrTable$IOP, corrTable$Age, method="spearman")
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age))
pcor.test(ANGPT2, IOP, Age, method="spearman", data=corrTable)
pcor.test(corrTable$ANGPT2, corrTable$IOP, corrTable$Age, method="spearman")
pcor.test(corrTable$IOP, corrTable$ANGPT2, corrTable$Age, method="spearman")
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age))
pcor.test(corrTable$ANGPT2, corrTable$IOP, corrTable$Batch, method="pearson")
######## Partial Correlation Tests (Dr. Chen) ########
corrTable <- cbind(sub_samples$Avg_IOP, sub_samples$AgeInDays, sub_samples$Batch, selGenes)    # Correlation tables for three genes
######## Partial Correlation Tests (Dr. Chen) ########
corrTable <- cbind(sub_samples$Avg_IOP, sub_samples$AgeInDays, sub_samples$Sex, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "Age", "Sex", "ANGPT2", "PTPRB", "TEK")
pcor.test(corrTable$ANGPT2, corrTable$IOP, c(corrTable$Sex, corrTable$Age), method="spearman")
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Sex))
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age+corrTable$Sex))
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age))
summary(lm(corrTable$ANGPT2~corrTable$IOP))
summary(lm(corrTable$ANGPT2~corrTable$IOP))
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age))
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Sex))
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age+corrTable$Sex))
pcor.test(corrTable$ANGPT2, corrTable$IOP, method="spearman")
summary(lm(corrTable$ANGPT2~corrTable$IOP))
pcor.test(corrTable$ANGPT2, corrTable$IOP, corrTable$Age, method="pearson")
ctl <- c(4.17,5.58,5.18,6.11,4.50,4.61,5.17,4.53,5.33,5.14)
trt <- c(4.81,4.17,4.41,3.59,5.87,3.83,6.03,4.89,4.32,4.69)
group <- gl(2, 10, 20, labels = c("Ctl","Trt"))
view(group)
weight <- c(ctl, trt)
view(weight)
lm.D9 <- lm(weight ~ group)
View(lm.D9)
summary(lm.D9)
anova(lm.D9)
lm.D9 <- lm(weight ~ group-1)
summary(lm.D9)
anova(lm.D9)
summary(lm(corrTable$ANGPT2~corrTable$IOP))
summary(lm(corrTable$ANGPT2~corrTable$IOP-1))
summary(lm(corrTable$ANGPT2~corrTable$IOP-1+corrTable$Age-1))
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age-1))
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Sex-1))
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age+corrTable$Sex-1))
summary(lm(corrTable$ANGPT2~corrTable$IOP))
anova(lm(corrTable$ANGPT2~corrTable$IOP))
lm(formula = ANGPT2 ~ IOP + Age, data = corrTable)
summary(lm(ANGPT2~IOP+Age, data=corrTable))
summary(lm(IOP~ANGPT2+Age, data=corrTable))
######## Correct Regression ##########
summary(lm(IOP~ANGPT2, data=corrTable))
summary(lm(IOP~ANGPT2+Age, data=corrTable))
summary(lm(IOP~ANGPT2+Sex, data=corrTable))
summary(lm(IOP~ANGPT2+Age+Sex, data=corrTable))
summary(lm(IOP~Age+Sex, data=corrTable))
######## Correct Regression ##########
summary(lm(IOP~ANGPT2, data=corrTable))
summary(lm(IOP~ANGPT2+Age, data=corrTable))
summary(lm(IOP~ANGPT2+Sex, data=corrTable))       #
summary(lm(IOP~ANGPT2+Age+Sex, data=corrTable))   #
summary(lm(ANGPT2~IOP, data=corrTable))           # p-value: 0.132
summary(lm(ANGPT2~IOP+Age, data=corrTable))       # p-value: 0.2208
summary(lm(ANGPT2~IOP+Sex, data=corrTable))       # p-value: 0.3468
summary(lm(ANGPT2~IOP+Age+Sex, data=corrTable))   # p-value: 0.4087
######## Omitting Intercept ##########
summary(lm(corrTable$ANGPT2~corrTable$IOP-1))
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age-1))
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Sex-1))
summary(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age+corrTable$Sex-1))
######## ANOVA ##########
anova(lm(corrTable$ANGPT2~corrTable$IOP))
######## ANOVA ##########
anova(lm(corrTable$ANGPT2~corrTable$IOP))                                   # p-value: < 2.2e-16
anova(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age))                     # p-value: < 2.2e-16
anova(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Sex))                     # p-value: < 2.2e-16
anova(lm(corrTable$ANGPT2~corrTable$IOP+corrTable$Age+corrTable$Sex))       # p-value: 0.1371
