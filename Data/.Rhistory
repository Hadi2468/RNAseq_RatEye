#######################################################################################
### DESeq2 Analysis and Normalization of the transcriptomic data for 53 rat samples ###
#######################################################################################
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
# BiocManager::install(version = "3.10")
# BiocManager::install("tximport")
# BiocManager::install("DESeq2")
install.packages("tidyverse")
install.packages("ggplot2")
#######################################################################################
### DESeq2 Analysis and Normalization of the transcriptomic data for 53 rat samples ###
#######################################################################################
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.10")
BiocManager::install("tximport")
BiocManager::install("DESeq2")
BiocManager::install("DESeq2")
install.packages("ggplot2")
Packages <- c("tximport", "DESeq2", "tidyverse", "ggplot2")
lapply(Packages, library, character.only = TRUE)
###################################################
### Step 1: Import 53 samples' information file ###
###################################################
dir <- setwd("./datasets"); getwd()
getwd()
###################################################
### Step 1: Import 53 samples' information file ###
###################################################
dir <- setwd("./RNAseq_RatEye/datasets"); getwd()
getwd()
setwd("../")
getwd()
setwd("../RNAseq_RatEye/datasets"); getwd()
getwd()
setwd("../RNAseq_RatEye"); getwd()
setwd("./RNAseq_RatEye"); getwd()
Packages <- c("tximport", "tximportData", "DESeq2", "tidyverse", "dplyr", "vctrs", "fs", "ggplot2")
lapply(Packages, library, character.only = TRUE)
getwd()
###################################################
### Step 1: Import 53 samples' information file ###
###################################################
setwd("./Data"); getwd()
samples <- read.csv("samples53.csv", sep=",", header=TRUE)
#   else if (0 < samples$Avg_IOP[i] & samples$Avg_IOP[i] < 15) {samples$Class_IOP[i] <- "Normal"}
#   else if (15 <= samples$Avg_IOP[i] & samples$Avg_IOP[i] < 20) {samples$Class_IOP[i] <- "Elevated"}
#   else {samples$Class_IOP[i] <- "High"} }
# for (i in (1:length(samples$Batch))) {
#   samples$Batch[i] <- if(samples$Batch[i] == "12") "B12" else if(samples$Batch[i] == "13") "B13" else if(samples$Batch[i] == "14") "B14" else "B15" }
# for (i in (1:length(samples$Class))) {
#   samples$Class[i] <- if(samples$Class[i] == "H") "High" else if(samples$Class[i] == "E") "Elevated" else "Normal" }
# samples <- new_samples[complete.cases(new_samples), ]         # remove 8 samples which have no IOP data ("NA")
# dim(samples)
# head(samples)
samples$Class_OD <- relevel(samples$Class_OD, "Normal")
samples$Class_OS <- relevel(samples$Class_OS, "Normal")
samples$Class_IOP <- relevel(samples$Class_IOP, "Normal")
getwd()
##########################################################################################
### Step 2: Import RSEM outputs(transcripts aboundance estimation) file using tximport ###
##########################################################################################
setwd("./rsem_export_dataset"); getwd()
RSEM_output_gene_files <- file.path(getwd(), paste0(samples$sample, ".genes.results"))
names(RSEM_output_gene_files) <- samples$sample
txi.rsem <- tximport(RSEM_output_gene_files, type="rsem", txIn=FALSE, txOut=FALSE)
#########################################################################################
### Step 3: Producing the DESeq2 data frame based on the outputs of Step 1 and Step 2 ###
#########################################################################################
# colnames(txi.rsem$counts)
# row.names(samples)
txi.rsem$length[txi.rsem$length == 0] <- 1
dds <- DESeqDataSetFromTximport(txi.rsem, samples, ~Class_IOP)
getwd()
###########################################
### Step 4: Normalization based on rlog ###
###########################################
setwd("../"); getwd()
vsd <- vst(dds, blind=FALSE)
rld <- rlog(dds, blind=FALSE)
# head(assay(rld), 3)
# write.table(assay(rld), file="normalized_IOP_Class.csv", sep=",", quote=F, col.names=NA)
# ntd <- normTransform(dds)
# meanSdPlot(assay(ntd))
# meanSdPlot(assay(vsd))
# meanSdPlot(assay(rld), bins = 100)
# sub_genes_rld <- data.frame(t(assay(rld)))
sub_genes_vst <- data.frame(t(assay(vsd)))
dim(sub_genes)
dim(sub_genes_vst)
# write.table(assay(rld), file="normalized_IOP_Class.csv", sep=",", quote=F, col.names=NA)
# ntd <- normTransform(dds)
# meanSdPlot(assay(ntd))
# meanSdPlot(assay(vsd))
# meanSdPlot(assay(rld), bins = 100)
# sub_genes_rld <- data.frame(t(assay(rld)))
# sub_genes_vst <- data.frame(t(assay(vsd)))
# dim(sub_genes_rld)
# dim(sub_genes_vst)
# sub_genes_rld <- sub_genes[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
sub_genes_vst <- sub_genes[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
# head(assay(rld), 3)
# write.table(assay(rld), file="normalized_IOP_Class.csv", sep=",", quote=F, col.names=NA)
# ntd <- normTransform(dds)
# meanSdPlot(assay(ntd))
# meanSdPlot(assay(vsd))
# meanSdPlot(assay(rld), bins = 100)
# sub_genes_rld <- data.frame(t(assay(rld)))
# sub_genes_vst <- data.frame(t(assay(vsd)))
# dim(sub_genes_rld)
dim(sub_genes_vst)
vsd <- vst(dds, blind=FALSE)
# head(assay(rld), 3)
# ntd <- normTransform(dds)
# meanSdPlot(assay(ntd))
# meanSdPlot(assay(vsd))
# meanSdPlot(assay(rld), bins = 100)
# sub_genes_rld <- data.frame(t(assay(rld)))
sub_genes_vst <- data.frame(t(assay(vsd)))
# dim(sub_genes_rld)
dim(sub_genes_vst)
# sub_genes_rld <- sub_genes_rld[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
sub_genes_vst <- sub_genes_vst[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
getwd()
# meanSdPlot(assay(ntd))
# meanSdPlot(assay(vsd))
# meanSdPlot(assay(rld), bins = 100)
# sub_genes_rld <- data.frame(t(assay(rld)))
# sub_genes_vst <- data.frame(t(assay(vsd)))
# dim(sub_genes_rld)
# dim(sub_genes_vst)
# sub_genes_rld <- sub_genes_rld[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
# sub_genes_vst <- sub_genes_vst[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
# write.table(sub_genes_rld, file="normalized_rlog_class_IOP.csv", sep=",", quote=F, row.names=TRUE, col.names=TRUE,)
write.table(sub_genes_vst, file="normalized_vst_class_IOP.csv", sep=",", quote=F, row.names=TRUE, col.names=TRUE,)
dim(sub_genes)
sub_genes <- read.csv("normalized_vst_class_IOP.csv", sep=",", header=TRUE)
dim(sub_genes)
# sub_samples <- samples[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
# write.table(sub_samples, file="samples45.csv", sep=",", quote=F, row.names=TRUE, col.names=TRUE,)
sub_samples <- read.csv("samples45.csv", sep=",", header=TRUE)
dim(sub_samples)
# BiocManager::install("")
# install.packages("corrplot")
# install.packages("RColorBrewer")
# install.packages("ggpubr")
# install.packages("pheatmap")
Packages <- c("tximport", "tximportData", "DESeq2", "tidyverse", "dplyr", "vctrs", "fs", "ggplot2",
"corrplot", "RColorBrewer", "ggpubr", "pheatmap")
lapply(Packages, library, character.only = TRUE)
getwd()
setwd("./"); getwd()
samples <- read.csv("samples53.csv", sep=",", header=TRUE)
dim(samples)
dim(samples)
# sub_samples <- samples[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
# write.table(sub_samples, file="samples45.csv", sep=",", quote=F, row.names=TRUE, col.names=TRUE,)
sub_samples <- read.csv("samples45.csv", sep=",", header=TRUE)
dim(sub_samples)
sub_genes <- read.csv("normalized_vst_class_IOP.csv", sep=",", header=TRUE)
dim(sub_genes)
selGenes <- subset(sub_genes, select=c(ENSRNOG00000016696_Angpt2, ENSRNOG00000055293_Ptprb, ENSRNOG00000008587_Tek))
View(selGenes)
corrTable <- cbind(sub_samples$Avg_OD, sub_samples$Avg_OS, sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
View(corrTable)
selGenes <- subset(sub_genes, select=c(ENSRNOG00000016696_Angpt2, ENSRNOG00000055293_Ptprb, ENSRNOG00000008587_Tek))
corrTable <- cbind(sub_samples$Avg_OD, sub_samples$Avg_OS, sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("OD", "OS", "IOP", "ANGPT2", "PTPRB", "TEK")
corrplot(cor(corrTablemethod="pearson"), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="PRGn"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="PRGn"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman "), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="PRGn"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="kendall"), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="PRGn"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman "), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="PRGn"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="PRGn"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
sub_genes <- read.csv("normalized_rlog_class_IOP.csv", sep=",", header=TRUE)
dim(sub_genes)
selGenes <- subset(sub_genes, select=c(ENSRNOG00000016696_Angpt2, ENSRNOG00000055293_Ptprb, ENSRNOG00000008587_Tek))
corrTable <- cbind(sub_samples$Avg_OD, sub_samples$Avg_OS, sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("OD", "OS", "IOP", "ANGPT2", "PTPRB", "TEK")
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="PRGn"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="lower", order="FPC", col=brewer.pal(n=7, name="PRGn"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="PRGn"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="RdYlBu"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="FPC", col=brewer.pal(n=9, name="RdYlBu"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="FPC", col=brewer.pal(n=9, name="RdBu"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="FPC", col=brewer.pal(n=9, name="BuRd"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="FPC", col=brewer.pal(n=9, name="RdBu"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="RdBu"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="RdBu"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="FPC", col=brewer.pal(n=7, name="RdBu"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust", col=brewer.pal(n=7, name="RdBu"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=brewer.pal(n=7, name="RdBu"),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("red", "white", "blue"))(20),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("blue", "white", "red"))(20),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("blue", "white", "red"))(10),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("blue", "white", "red"))(20),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("blue", "white", "red"))(10),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("blue", "white", "red"))(7),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("cyan", "white", "red"))(7),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("cyan", "yellow", "red"))(7),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("Blue", "yellow", "red"))(7),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("Blue", "aliceblue", "red"))(7),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("dodgerblue", "aliceblue", "red"))(7),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("dodgerblue", "aliceblue", "firebrick1"))(7),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("dodgerblue", "aliceblue", "indianred1"))(7),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("dodgerblue", "aliceblue", "red"))(7),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
brown1
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust", col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col = "black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(9), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(20), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(11), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="alphabet",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order=c(1,2,3,4,5,6),
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order=c("OD", "OS", "IOP", "ANGPT2", "PTPRB", "TEK"),
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="AOE",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="AOE",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="alphabet",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
names(corrTable) <- c("_OD", "OS", "IOP", "ANGPT2", "PTPRB", "TEK")
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="alphabet",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
names(corrTable) <- c("_OD", "_OS", "_IOP", "ANGPT2", "PTPRB", "TEK")
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="alphabet",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="kendall"), method="color", type="upper", order="FPC",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="alphabet",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="alphabet",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="kendall"), method="color", type="upper", order="FPC",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
pheatmap(cor(corrTable))
sub_genes <- read.csv("normalized_vst_class_IOP.csv", sep=",", header=TRUE)
dim(sub_genes)
selGenes <- subset(sub_genes, select=c(ENSRNOG00000016696_Angpt2, ENSRNOG00000055293_Ptprb, ENSRNOG00000008587_Tek))
corrTable <- cbind(sub_samples$Avg_OD, sub_samples$Avg_OS, sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("_OD", "_OS", "_IOP", "ANGPT2", "PTPRB", "TEK")
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="alphabet",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="kendall"), method="color", type="upper", order="FPC",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7), addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
pheatmap(cor(corrTable))
corrTable_new <- cbind(sub_samples$Sex, corrTable)    # Correlation tables for three genes
View(corrTable_new)
names(corrTable) <- c("Sex", "OD", "OS", "IOP", "ANGPT2", "PTPRB", "TEK")
names(corrTable_new) <- c("Sex", "OD", "OS", "IOP", "ANGPT2", "PTPRB", "TEK")
ggscatter(corrTable, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size = 1, color = "Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size = 1, color = "Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size = 1, color = "Red", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size = 1, fill="Sex", color = "Red", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size = 1, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size = 1, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=FALSE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size = 1, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size = 1, color="Sex", cor.method="pearson",
combine = FALSE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
3
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=21, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=2, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=1, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=21, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=5, shape=21, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=5, shape=1, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=5, shape=21, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=5, shape=19, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=5, shape=16, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=5, shape=15, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=5, shape=20, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=5, shape=22, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=5, shape=19, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=TRUE, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette = c("black", "red", "yellow")))
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette = c("black", "red", "yellow"))
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "bloue"))
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Pearson Correlation"
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Pearson Correlation",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Pearson Correlation",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OS", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Pearson Correlation",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="IOP", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Pearson Correlation",
)
ggscatter(corrTable_new, x="IOP", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Pearson Correlation",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Correlation: Pearson, Normalization: vst",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OS", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Correlation: Pearson, Normalization: vst",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OS", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Correlation: Pearson, Normalization: vst",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OS", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="IOP", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Correlation: Pearson, Normalization: vst",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="IOP", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="spearman", title="Correlation: Spearman, Normalization: vst",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OS", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="spearman", title="Correlation: Spearman, Normalization: vst",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OS", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="IOP", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="spearman", title="Correlation: Spearman, Normalization: vst",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="IOP", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="kendall", title="Correlation: Kendall, Normalization: vst",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OS", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="kendall", title="Correlation: Kendall, Normalization: vst",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OS", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="IOP", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="kendall", title="Correlation: Kendall, Normalization: vst",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="IOP", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
sub_genes <- read.csv("normalized_rlog_class_IOP.csv", sep=",", header=TRUE)
dim(sub_genes)
selGenes <- subset(sub_genes, select=c(ENSRNOG00000016696_Angpt2, ENSRNOG00000055293_Ptprb, ENSRNOG00000008587_Tek))
corrTable <- cbind(sub_samples$Avg_OD, sub_samples$Avg_OS, sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("_OD", "_OS", "_IOP", "ANGPT2", "PTPRB", "TEK")
corrTable_new <- cbind(sub_samples$Sex, corrTable)    # Correlation tables for three genes
names(corrTable_new) <- c("Sex", "OD", "OS", "IOP", "ANGPT2", "PTPRB", "TEK")
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Correlation: Pearson, Normalization: vst",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
ggscatter(corrTable_new, x="OD", y=c("PTPRB", "ANGPT2", "TEK"), size=3, shape=19, color="Sex", cor.method="pearson", title="Correlation: Pearson, Normalization: rlog",
combine = TRUE, add="reg.line", conf.int=F, cor.coef=TRUE, xlab="OD", ylab="Normalized gene counts", palette=c("red", "pink", "blue"))
