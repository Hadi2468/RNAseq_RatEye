#######################################################################################
### DESeq2 Analysis and Normalization of the transcriptomic data for 53 rat samples ###
#######################################################################################
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
# BiocManager::install(version = "3.10")
# BiocManager::install("tximport")
# BiocManager::install("DESeq2")
install.packages("tidyverse")
install.packages("ggplot2")
#######################################################################################
### DESeq2 Analysis and Normalization of the transcriptomic data for 53 rat samples ###
#######################################################################################
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.10")
BiocManager::install("tximport")
BiocManager::install("DESeq2")
BiocManager::install("DESeq2")
install.packages("ggplot2")
Packages <- c("tximport", "DESeq2", "tidyverse", "ggplot2")
lapply(Packages, library, character.only = TRUE)
###################################################
### Step 1: Import 53 samples' information file ###
###################################################
dir <- setwd("./datasets"); getwd()
getwd()
###################################################
### Step 1: Import 53 samples' information file ###
###################################################
dir <- setwd("./RNAseq_RatEye/datasets"); getwd()
getwd()
setwd("../")
getwd()
setwd("../RNAseq_RatEye/datasets"); getwd()
getwd()
setwd("../RNAseq_RatEye"); getwd()
setwd("./RNAseq_RatEye"); getwd()
getwd(); setwd("./Data"); getwd()
samples <- read.csv("samples53.csv", sep=",", header=TRUE)
dim(samples)
View(samples)
# sub_samples <- samples[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
# write.table(sub_samples, file="samples45.csv", sep=",", quote=F, row.names=TRUE, col.names=TRUE,)
sub_samples <- read.csv("samples45.csv", sep=",", header=TRUE)
sub_samples <- samples[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
write.table(sub_samples, file="samples45.csv", sep=",", quote=F, row.names=TRUE, col.names=TRUE,)
# sub_samples <- samples[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
# write.table(sub_samples, file="samples45.csv", sep=",", quote=F, row.names=TRUE, col.names=TRUE,)
sub_samples <- read.csv("samples45.csv", sep=",", header=TRUE)
dim(sub_samples)
sub_genes <- read.csv("normalized_rlog_class_IOP.csv", sep=",", header=TRUE)
#   else if (15 <= samples$Avg_OD[i] & samples$Avg_OD[i] < 20) {samples$Class_OD[i] <- "Elevated"}
#   else {samples$Class_OD[i] <- "High"}
#   if (samples$Avg_OS[i] == 0) {samples$Class_OS[i] <- "NoData"}
#   else if (0 < samples$Avg_OS[i] & samples$Avg_OS[i] < 15) {samples$Class_OS[i] <- "Normal"}
#   else if (15 <= samples$Avg_OS[i] & samples$Avg_OS[i] < 20) {samples$Class_OS[i] <- "Elevated"}
#   else {samples$Class_OS[i] <- "High"}
#   if (samples$Avg_IOP[i] == 0) {samples$Class_IOP[i] <- "NoData"}
#   else if (0 < samples$Avg_IOP[i] & samples$Avg_IOP[i] < 15) {samples$Class_IOP[i] <- "Normal"}
#   else if (15 <= samples$Avg_IOP[i] & samples$Avg_IOP[i] < 20) {samples$Class_IOP[i] <- "Elevated"}
#   else {samples$Class_IOP[i] <- "High"} }
boxplot(sub_samples$AgeInDays)
quantile(sub_samples$AgeInDays, c(0.25, 0.5, 0.75), type = 1)
#   else if (15 <= samples$Avg_OD[i] & samples$Avg_OD[i] < 20) {samples$Class_OD[i] <- "Elevated"}
#   else {samples$Class_OD[i] <- "High"}
#   if (samples$Avg_OS[i] == 0) {samples$Class_OS[i] <- "NoData"}
#   else if (0 < samples$Avg_OS[i] & samples$Avg_OS[i] < 15) {samples$Class_OS[i] <- "Normal"}
#   else if (15 <= samples$Avg_OS[i] & samples$Avg_OS[i] < 20) {samples$Class_OS[i] <- "Elevated"}
#   else {samples$Class_OS[i] <- "High"}
#   if (samples$Avg_IOP[i] == 0) {samples$Class_IOP[i] <- "NoData"}
#   else if (0 < samples$Avg_IOP[i] & samples$Avg_IOP[i] < 15) {samples$Class_IOP[i] <- "Normal"}
#   else if (15 <= samples$Avg_IOP[i] & samples$Avg_IOP[i] < 20) {samples$Class_IOP[i] <- "Elevated"}
#   else {samples$Class_IOP[i] <- "High"} }
boxplot(sub_samples$AgeInDays, col="blue")
#   else if (15 <= samples$Avg_OD[i] & samples$Avg_OD[i] < 20) {samples$Class_OD[i] <- "Elevated"}
#   else {samples$Class_OD[i] <- "High"}
#   if (samples$Avg_OS[i] == 0) {samples$Class_OS[i] <- "NoData"}
#   else if (0 < samples$Avg_OS[i] & samples$Avg_OS[i] < 15) {samples$Class_OS[i] <- "Normal"}
#   else if (15 <= samples$Avg_OS[i] & samples$Avg_OS[i] < 20) {samples$Class_OS[i] <- "Elevated"}
#   else {samples$Class_OS[i] <- "High"}
#   if (samples$Avg_IOP[i] == 0) {samples$Class_IOP[i] <- "NoData"}
#   else if (0 < samples$Avg_IOP[i] & samples$Avg_IOP[i] < 15) {samples$Class_IOP[i] <- "Normal"}
#   else if (15 <= samples$Avg_IOP[i] & samples$Avg_IOP[i] < 20) {samples$Class_IOP[i] <- "Elevated"}
#   else {samples$Class_IOP[i] <- "High"} }
boxplot(sub_samples$AgeInDays, col="pink")
#   else if (15 <= samples$Avg_OD[i] & samples$Avg_OD[i] < 20) {samples$Class_OD[i] <- "Elevated"}
#   else {samples$Class_OD[i] <- "High"}
#   if (samples$Avg_OS[i] == 0) {samples$Class_OS[i] <- "NoData"}
#   else if (0 < samples$Avg_OS[i] & samples$Avg_OS[i] < 15) {samples$Class_OS[i] <- "Normal"}
#   else if (15 <= samples$Avg_OS[i] & samples$Avg_OS[i] < 20) {samples$Class_OS[i] <- "Elevated"}
#   else {samples$Class_OS[i] <- "High"}
#   if (samples$Avg_IOP[i] == 0) {samples$Class_IOP[i] <- "NoData"}
#   else if (0 < samples$Avg_IOP[i] & samples$Avg_IOP[i] < 15) {samples$Class_IOP[i] <- "Normal"}
#   else if (15 <= samples$Avg_IOP[i] & samples$Avg_IOP[i] < 20) {samples$Class_IOP[i] <- "Elevated"}
#   else {samples$Class_IOP[i] <- "High"} }
boxplot(sub_samples$AgeInDays, col="pink", ylab="Age")
quantile(sub_samples$AgeInDays, c(0.25, 0.5, 0.75), type = 1)
