#######################################################################################
### DESeq2 Analysis and Normalization of the transcriptomic data for 53 rat samples ###
#######################################################################################
# if (!requireNamespace("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
# BiocManager::install(version = "3.10")
# BiocManager::install("tximport")
# BiocManager::install("DESeq2")
install.packages("tidyverse")
install.packages("ggplot2")
#######################################################################################
### DESeq2 Analysis and Normalization of the transcriptomic data for 53 rat samples ###
#######################################################################################
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install(version = "3.10")
BiocManager::install("tximport")
BiocManager::install("DESeq2")
BiocManager::install("DESeq2")
install.packages("ggplot2")
Packages <- c("tximport", "DESeq2", "tidyverse", "ggplot2")
lapply(Packages, library, character.only = TRUE)
###################################################
### Step 1: Import 53 samples' information file ###
###################################################
dir <- setwd("./datasets"); getwd()
getwd()
###################################################
### Step 1: Import 53 samples' information file ###
###################################################
dir <- setwd("./RNAseq_RatEye/datasets"); getwd()
getwd()
setwd("../")
getwd()
setwd("../RNAseq_RatEye/datasets"); getwd()
getwd()
setwd("../RNAseq_RatEye"); getwd()
setwd("./RNAseq_RatEye"); getwd()
pheatmap(cor(corrTable))
Packages <- c("tximport", "tximportData", "DESeq2", "tidyverse", "dplyr", "vctrs", "fs", "ggplot2",
"corrplot", "RColorBrewer", "ggpubr", "pheatmap", "ppcor", "BBmisc", "rcompanion") #"mAPKL",
lapply(Packages, library, character.only = TRUE)
getwd()
setwd("./Data"); getwd()
samples <- read.csv("samples53.csv", sep=",", header=TRUE)
dim(samples)
# samples <- read.csv("samples53.csv", sep=",", header=TRUE)
# dim(samples)
# sub_samples <- samples[-c(3, 14, 42, 43, 44, 45, 46, 47), ]
# write.table(sub_samples, file="samples45.csv", sep=",", quote=F, row.names=TRUE, col.names=TRUE,)
sub_samples <- read.csv("samples45.csv", sep=",", header=TRUE)
dim(sub_samples)
# sub_genes_2 <- read.csv("normalized_log2.csv", sep=",", header=TRUE)
sub_genes_r <- read.csv("normalized_rlog.csv", sep=",", header=TRUE)
# sub_genes_r <- read.csv("normalized_rlog_IOP.csv", sep=",", header=TRUE) # Genes + IOP
# sub_genes_v <- read.csv("normalized_vst.csv", sep=",", header=TRUE)
# sub_genes_c <- read.csv("real_counts.csv", sep=",", header=TRUE)
# dim(sub_genes_2)
dim(sub_genes_r)
# selGenes <- subset(sub_genes_2, select=c(ENSRNOG00000016696_Angpt2, ENSRNOG00000055293_Ptprb, ENSRNOG00000008587_Tek))
selGenes <- subset(sub_genes_r, select=c(ENSRNOG00000016696_Angpt2, ENSRNOG00000055293_Ptprb, ENSRNOG00000008587_Tek))
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
# names(corrTable) <- c("IOP", "IOP_norm", "ANGPT2", "PTPRB", "TEK")
summary(corrTable)     # Basic statistical analysis
# ggqqplot(corrTable$ANGPT2)
# ggqqplot(corrTable$PTPRB)
# ggqqplot(corrTable$TEK)
# ggqqplot(corrTable$IOP)
shapiro.test(corrTable$ANGPT2)
shapiro.test(corrTable$PTPRB)
shapiro.test(corrTable$TEK)
shapiro.test(corrTable$IOP)
normalize_2 <- function(x) {return ((x - mean(x)) / sd(x))}
corrTable$IOP <- normalize_2(corrTable$IOP)
View(corrTable)
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP_norm)) + geom_density(fill="green")
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
pheatmap(cor(corrTable))
corrplot(cor(corrTable, method="pearson"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
View(corrTable)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
View(corrTable)
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
# names(corrTable) <- c("IOP", "IOP_norm", "ANGPT2", "PTPRB", "TEK")
summary(corrTable)     # Basic statistical analysis
normalize_3 <- function(x) {return ( 1+1023*(x - min(x)) / sd(x))}
corrTable$IOP <- normalize_3(corrTable$IOP)
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
corrTable$IOP <- preprocess(corrTable$IOP,log2=TRUE, norm="ALL", destname=NULL)
# BiocManager::install("")
# install.packages("corrplot")
# install.packages("RColorBrewer")
# install.packages("ggpubr")
# install.packages("pheatmap")
# install.packages("ppcor")
# install.packages("rcompanion")
install.packages("caret")
Packages <- c("tximport", "tximportData", "DESeq2", "tidyverse", "dplyr", "vctrs", "fs", "ggplot2",
"corrplot", "RColorBrewer", "ggpubr", "pheatmap", "ppcor", "BBmisc", "rcompanion", "caret") #"mAPKL",
lapply(Packages, library, character.only=TRUE)
corrTable$IOP <- preprocess(corrTable$IOP,log2=TRUE, norm="ALL", destname=NULL)
library(caret)
corrTable$IOP <- preprocess(corrTable$IOP)
corrTable$IOP <- preProcess(corrTable$IOP)
corrTable$IOP <- preProcess(corrTable$IOP,log2=TRUE, norm="ALL", destname=NULL)
set.seed(96)
inTrain <- sample(seq(along = mdrrClass), length(mdrrClass)/2)
training <- filteredDescr[inTrain,]
preProcess(corrTable$IOP, method = c("center", "scale"))
corrTable$IOP <- preProcess(corrTable,log2=TRUE, norm="ALL", destname=NULL)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
corrTable$IOP <- preProcess(corrTable$IOP,log2=TRUE, norm="ALL", destname=NULL)
corrTableh <- preProcess(corrTable,log2=TRUE, norm="ALL", destname=NULL)
View(corrTableh)
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
preProcess(corrTable$IOP, method = c("BoxCox"))
corrTableh <- preProcess(corrTable, method = c("BoxCox"))
View(corrTableh)
corrTableh
lambda = -0.1
T_box = (corrTable$IOP ^ lambda - 1)/lambda   # Transform the original data
plotNormalHistogram(T_box)
corrTable$IOP_norm <- T_box
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
corrTable$IOP <- T_box
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
lambda = -0.9  # -0.1, -0.9, 0.7, 2
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
T_box = (corrTable$IOP ^ lambda - 1)/lambda   # Transform the original data
plotNormalHistogram(T_box)
corrTable$IOP <- T_box
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
lambda = 0.7  # -0.1, -0.9, 0.7, 2
lambda = 0.7  # -0.1, -0.9, 0.7, 2
T_box = (corrTable$IOP ^ lambda - 1)/lambda   # Transform the original data
plotNormalHistogram(T_box)
corrTable$IOP <- T_box
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
lambda = 2  # -0.1, -0.9, 0.7, 2
T_box = (corrTable$IOP ^ lambda - 1)/lambda   # Transform the original data
plotNormalHistogram(T_box)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
lambda = 2  # -0.1, -0.9, 0.7, 2
T_box = (corrTable$IOP ^ lambda - 1)/lambda   # Transform the original data
plotNormalHistogram(T_box)
corrTable$IOP <- T_box
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
lambda = -0.1  # -0.1, -0.9, 0.7, 2
T_box = (corrTable$IOP ^ lambda - 1)/lambda   # Transform the original data
plotNormalHistogram(T_box)
corrTable$IOP <- T_box
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
corrTableh
names(corrTableh)
names(corrTableh)[2]
names(names(corrTableh)[2])
(corrTableh)[2]
(corrTableh)[2].IOP
(corrTableh)[2]$IOP
names.((corrTableh)[2]
)
(corrTableh)[2]$bc$IOP
(corrTableh)[2]$bc$IOP$lambda
corrTableh[2]$bc$IOP$lambda
########## Box-Cox power transformation ##########
Lambda = preProcess(corrTable, method=c("BoxCox"))[2]$bc$IOP$lambda
Lambda
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
########## Box-Cox power transformation ##########
Lambda = preProcess(corrTable, method=c("BoxCox"))[2]$bc$IOP$lambda
Lambda
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
##### Method 3: Box-Cox power transformation #####
Lambda = preProcess(corrTable, method=c("BoxCox"))[2]$bc$IOP$lambda
corrTable$IOP = (corrTable$IOP ^ Lambda - 1) / Lambda
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
corrTable$IOP <- log2(corrTable$IOP)
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrTable$IOP <- normalize(corrTable$IOP, method="standardize", range=c(0, 1), margin=1L, on.constant="quiet")
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
corrTable$IOP <- normalize(corrTable$IOP, method="standardize", range=c(0, 1), margin=1L, on.constant="quiet")
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
corrTable$IOP <- log(corrTable$IOP)
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
corrplot(cor(corrTable, method="spearman"), method="color", type="upper", order="hclust",
col=colorRampPalette(c("dodgerblue", "aliceblue", "brown1"))(7),
addCoef.col="black", tl.col="black", tl.cex=1, addrect=3)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
corrTable$IOP <- log10(corrTable$IOP)
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
ggplot(corrTable, aes(IOP)) + geom_density(fill="green")
##### Method 4: Log transformation #####
corrTable$IOP <- log(corrTable$IOP)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
##### Method 4: Log transformation #####
corrTable$IOP <- log(corrTable$IOP)
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
corrTable$IOP <- log2(corrTable$IOP)
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
corrTable$IOP <- log10(corrTable$IOP)
summary(corrTable$IOP)
shapiro.test(corrTable$IOP)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
##### Method 4: Log transformation #####
corrTable$IOP <- log(corrTable$IOP)
summary(corrTable$IOP)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
corrTable$IOP <- log2(corrTable$IOP)
summary(corrTable$IOP)
corrTable <- cbind(sub_samples$Avg_IOP, selGenes)    # Correlation tables for three genes
names(corrTable) <- c("IOP", "ANGPT2", "PTPRB", "TEK")
corrTable$IOP <- log10(corrTable$IOP)
summary(corrTable$IOP)
